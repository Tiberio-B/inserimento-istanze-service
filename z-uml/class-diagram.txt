@startuml

	package "Controller" as contr #Application {
		abstract class IstanzaController {
			- {field} validator : IstanzaValidator
			- {field} service : IstanzaService
			- {field} authService : AuthService
			..
			~ {method} insert : ResponseEntity<MessageDto>
			> {method} token : String ,
			> {method} requestDto : IstanzaDto,
			> {method} br : BindingResult
		}
		class DecretoSvincoloReintroitoController << @RestController >> {
			+ {method} @PostMapping post : ResponseEntity<MessageDto>
			> {method} token : String,
			> {method} requestDto : DecretoSvincoloReintroitoDto,
			> {method} br : BindingResult
		}
		class DepositoAmministrativoController << @RestController >> {
			+ {method} @PostMapping post : ResponseEntity<MessageDto>
			> {method} token : String,
			> {method} requestDto : DepositoAmministrativoDto,
			> {method} br : BindingResult
		}
		class DepositoAmministrativoNoEsproprioController << @RestController >> { 
			+ {method} @PostMapping post : ResponseEntity<MessageDto>
			> {method} token : String,
			> {method} requestDto : DepositoAmministrativoNoEsproprioDto,
			> {method} br : BindingResult
		}
  		class DepositoCauzionaleController << @RestController >> {
			+ {method} @PostMapping post : ResponseEntity<MessageDto>
			> {method} token : String,
			> {method} requestDto : DepositoCauzionaleDto,
			> {method} br : BindingResult
		}
		class DepositoGiudiziarioController << @RestController >> {
			+ {method} @PostMapping post : ResponseEntity<MessageDto>
			> {method} token : String,
			> {method} requestDto : DepositoGiudiziarioDto,
			> {method} br : BindingResult
		}
		class DepositoVolontarioController << @RestController >> {
			+ {method} @PostMapping post : ResponseEntity<MessageDto>
			> {method} token : String,
			> {method} requestDto : DepositoVolontarioDto,
			> {method} br : BindingResult
		}
		class RestituzioneDepositoController << @RestController >> {
			+ {method} @PostMapping post : ResponseEntity<MessageDto>
			> {method} token : String,
			> {method} requestDto : RestituzioneDepositoDto,
			> {method} br : BindingResult
		}

		class DepositoAmministrativoController extends IstanzaController
		class DepositoAmministrativoNoEsproprioController extends IstanzaController
  		class DepositoCauzionaleController extends IstanzaController
		class DepositoGiudiziarioController extends IstanzaController
		class RestituzioneDepositoController extends IstanzaController
		class DecretoSvincoloReintroitoController extends IstanzaController
		class DepositoVolontarioController extends IstanzaController

		class IstanzaValidator
	}

	package "Service" as serv #Business {
		class IstanzaService << @Service >> {
			- {field} entitaService : EntitaService
			- {field} soggettoService : SoggettoService
			- {field} rtsService : RtsService
			- {field} catastoService : catastoService
			..
			+ {method} insert : MessageDto
			> {method} requestDto : IstanzaDto 
			< {method} throws SvildepException
		}
	}

	package "ExternalService" as ext #Strategy {
		abstract class ExternalService {
			- {field} restTemplate : RestTemplate
			+ {method} getURL() : String
		}
		class AuthService << @Service >> {
			+ {method} ottieniUtenteAutorizzato : UtenteDto
			> {method} token : String,
			> {method} requiredRoles : Role...
			< {method} throws AuthorizationException
		}
		class EntitaService << @Service >> {
			+ {method} inserisciIstanza : MessageDto
			> {method} istanza : IstanzaDto
			< {method} throws SvildepException
		}
		class SoggettoService << @Service >> {
			+ {method} verificaSoggetti : MessageDto
			> {method} soggetti : SoggettoDto
			< {method} throws SvildepException
		}
		class RtsService << @Service >> {
			+ {method} inserimentoInFascicolo : MessageDto
			> {method} documenti : Set<DocumentoDto>
			< {method} throws SvildepException
		}
		class CatastoService << @Service >> {
			+ {method} verificaDatiCatasto : MessageDto
			> {method} datiCatasto : CatastoDto
			< {method} throws SvildepException
		}
	}

		IstanzaController::service -down[thickness=6]- IstanzaService : service
		IstanzaController::authService -- AuthService : authentication
		IstanzaController::validator -- IstanzaValidator : validator

		IstanzaService::soggettoService -- SoggettoService
		IstanzaService::rtsService -- RtsService
		IstanzaService::entitaService -- EntitaService
		IstanzaService::catastoService -- CatastoService

		AuthService -[hidden]down- EntitaService
		EntitaService -[hidden]down- SoggettoService
		SoggettoService -[hidden]down- RtsService 
		RtsService -[hidden]down- CatastoService 

		AuthService -left-|> ExternalService
		EntitaService -left-|> ExternalService
		SoggettoService -left-|> ExternalService
		RtsService -left-|> ExternalService
		CatastoService -left-|> ExternalService

		DepositoAmministrativoController -[hidden]down- DepositoAmministrativoNoEsproprioController
		DepositoCauzionaleController -[hidden]down- DepositoGiudiziarioController
		RestituzioneDepositoController -[hidden]down- DecretoSvincoloReintroitoController

		

@enduml
-txmi:star